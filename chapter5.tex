\chapter{Conclusion}

Taxa-function relationships are difficult to characterize due to the different scales in which they operate \cite{langille2018exploring}. For the taxonomic layer, one can look at species, strain, or even cell states \cite{mcnulty2021dropletbased}. For the functional layer, it can be gene family abundance, transcript expression, or metabolite concentrations. Each degree of granularity increases the complexity of both the data collection process as well as its interpretation. However, no approach is ``wrong" as each taxa-function combination can reveal unique biological knowledge. For example, even in the face of strain-level variation, an analysis of genus level taxa and metabolite abundances can show that perhaps the metabolism of certain metabolites are phylogenetically conserved, which can have various implications. Throughout this thesis, we have attempted to decipher this relationship using multiple approaches. In chapter 2, we utilized a multi-omic data set to identify strongly associated microbe-metabolite pairs. In chapter 3, we developed a statistical method to leverage pre-defined taxa-function annotations (in the form of sets) in standard epidemiological studies. In chapter 4, we evaluated an example of such a source using trait databases aggregated from the literature.  

\section{Summary of findings}
\subsection{Mapping microbes to their function using multi-omics data}

In chapter 2, we examined a paired metataxonomic-metabolomic data set to explore the relationship between bacterial relative abundances and metabolite concentrations. Even though multi-omics studies involving metabolomics are not new \cite{lloyd-price2019multiomics, ayeni2018infant, kisuse2018urban}, most studies have focused on defining differences between subject case/control status, with limited exploration of the microbe-metabolite interface. Here, we characterized associations between the microbiome (profiled using 16S rRNA gene sequencing) and the metabolome (profiled using Nuclear Magnetic Resonance -- NMR -- techniques). The analyzed metabolomic data set contained both untargeted taxonomic bins, as well as  concentrations of 36 specific metabolites. This data was generated from a cohort of healthy infants from the New Hampshire Birth Cohort Study (NHBCS) \cite{gilbert-diamond2011rice} with samples collected at 6-weeks and 12-months of age. 

Using both Procrustes analysis and sparse cannonical correlation analysis (sCCA) \cite{witten2009penalized}, we found that overall metabolite concentrations are concordant with genus-level taxonomic profiles. This relationship was weakly predictive, as we observed poor performance across different machine learning models using predictive $R^2$ as the evaluation metric. However, model outputs performed better using Spearman correlation $\rho$, but still lower compared to other studies using a similar performance metric \cite{mallick2019predictive}. Using $\rho = 0.3$ as a threshold for defining ``well-predicted" metabolites \cite{mallick2019predictive, muller2021metaanalysis}, we found that short chain fatty acids (SCFAs) such as butyrate are most predictive, consistent with our understanding of microbiome physiology \cite{leblanc2017beneficial}. Surprisingly, the degree of coupling is higher for infants at 6-weeks compared to 12-months, suggesting that in early life humans are more reliant on the microbiome for metabolic purposes. 

In addition to overall patterns of associations, we also identified genera-metabolite groups that are core to the overall multivariate correlation by looking at the non-zero loading coefficients of our sCCA model. Similar to our concordance analysis, two SCFAs Butyrate and Proprionate were selected as the most important for the overall microbiome-metabolome relationship, with a surprising negative correlation with \emph{Bifidobacterium} genera, a commonly identified producer of SCFAs \cite{james2019metabolism}. We hypothesized that this is an instance of strain-level variation where some strains of \emph{Bifidobacterium} compete with other butyrate-producing taxa \cite{riviere2016bifidobacteria}. Amino acids were also well-represented among selected metabolites and were negatively correlated with taxa abundances. We hypothesized that microbes are incorporating amino acids in their environment directly instead of catabolizing them due to the fact that this process is energetically inefficient \cite{franzosa2014relating, oliphant2019macronutrient}. 

Our study showed that genus level microbial abundances are not sufficient to predict metabolite concentrations. However there is still a degree of overall coupling that is supported by prior work \cite{ayeni2018infant, kisuse2018urban, zierer2018fecal}. Additional studies with higher taxonomic resolution using whole genome metagenomics can be used to find more granular scales of association. We also provided further evidence to support the importance of microbiome-mediated butyrate catabolism in early life, while also suggesting that amino acids might play an important role. However, our study was limited by our cross-sectional design. This is because metabolite abundances are always changing, making measures of flux (or rate of change) more meaningful in finding associations \cite{hollywood2006metabolomics}. Some studies have attempted to bridge this gap using genome-scale metabolic models \cite{noecker2019defining}, which can be fitted to observed data. However, additional studies with dense longitudinal sampling are still needed.   

\subsection{Developing novel methods to integrate taxa-function relationships in statistical analyses}

In chapter 3, we developed a statistical method to test for the enrichment of groups of microbes. Gene set testing (or pathway analysis), is a commonly utilized in the genomics literature to aggregate lists of genes obtained after a differential abundance test \cite{irizarry2009gene, goeman2007analyzing}. These methods have been shown to improve power, reproduciblity, and interpretability \cite{khatri2012ten}. As such, set-based analysis can be a useful method to not only address some of the challenges of analyzing sequencing-based taxonomic data tables (such as sparsity) \cite{li2015microbiome}, but also to provide a formal statistical approach to incorporate taxa and function via sets. Here, we provided a method for set-based enrichment analysis called competitive balances for taxonomic enrichment analysis (CBEA) that is tailored to microbiome relative abundance data. CBEA generates sample-level scores in an unsupervised manner by integrating the $Q_1$ competitive null hypothesis \cite{tian2005discovering} and compositional balances \cite{silverman2017phylogenetic, egozcue2003isometric}. Inference is performed at the sample-level through estimating an empirical null distribution that can be adjusted for variance inflation due to inter-taxa correlation. 

We evaluated our model using both real and simulated data sets. First, CBEA can be used to test for enrichment at the sample level. Results indicated that our approach was able to control for type I error at the appropriate $\alpha$ level, however, the trade off was limited power to detect small effect sizes, especially at higher degrees of inter-taxa correlation. In addition, CBEA can also perform population-level analyses to detect sets that are differentially abundant between case/control status by combining generated scores with a difference in means test (such as Welch's t-test). Under this task, CBEA was able to control well for type I error but without having to concede as much power. Notably, CBEA produced fewer false positives compared to using a sum-based approach to aggregate taxa to sets and performing a standard differential abundance test such as \texttt{corncob} \cite{martin2020modeling}. Finally, even though CBEA generated scores were informative for discriminating between healthy controls and patients with IBD, performance scores were not significantly higher than other comparison methods.  

Our study illustrates an example of a statistical method that can assist in generating taxa-function hypotheses through the use of set annotations. Using CBEA, users can not only perform inference, but also use CBEA sample scores for downstream analyses such as predictive modeling, sample ordination, or network analysis. However, additional follow-up approaches are required to improve the inference procedure, as well address data sparsity beyond pseudocounts. 

\subsection{Leveraging existing microbiology knowledge to define microbial ecosystem roles}

In chapter 4, we explored using an aggregated database of microbial traits defined based on laboratory experiments to curate function-based taxon sets. Traits represents microbial phenotypic characteristics and are oriented towards describing ecosystem functions given their long history in ecological research \cite{krause2014traitbased}. We drew on two sources: Madin et al. \cite{madin2020synthesis} which is a comprehensive compilation of traits across multiple different static repositories, and Weissman et al. \cite{weissman2021exploring}, which provides a human microbiome centric annotations based on a manual curation of Bergey's manual. We constructed our sets based on categorical traits assembled, focusing on ``pathways" and ``substrates" as they represent traits that relate to microbes' participation in host biochemical processes.   

First, we computed the coverage of traits across body sites and trait categories using the HMP data set. We found that trait coverage is low when considering the proportion of taxa covered, but much higher when accounting for their relative abundances. This suggested that traits are well annotated for the abundant taxa within each community, but less so for rare microbes. We did not identify significant differences in average coverage across body sites, but some body sites have much lower coverage in some traits compared to others. It was difficult to annotate traits for 16S rRNA gene sequencing data sets since traits are defined at the species level. This is because the databases are not well sampled enough across the tree of life to enable comprehensive profiling of all genera. Furthermore, of strain and species level variability \cite{lloyd-price2017strains} complicates the process of aggregating traits.   

We then utilized CBEA (as described in chapter 3), to generate enrichment scores for trait-sets and utilized them as inputs to predictive models. We found that trait scores are as good as pathway abundances in discriminating between case and control patients, suggesting that they can be informative features. Surprisngly, performance held for the 16S rRNA gene sequencing data sets when compared against PICRUSt2 predicted pathway abundances, despite lower coverage. We also looked at the top 10 most informative features for our models and found that some traits correspond with known disease-associated biochemical pathways.  

Our results demonstrated that set-based analysis can help integrate taxa and function under one unified framework for hypothesis testing. Set annotations based on traits provide an interesting avenue, given that they are sourced from laboratory experiments with descriptions that are less granular but more interpretable than MetaCyc pathways. Even though trait coverage for rare species is limited, trait-based sets are still informative in distinguishing healthy patients from those with colorectal cancer and inflammatory bowel disease, suggesting that traits represent meaningful biological processes. As such, additional studies are needed to further refine the ontology of describing traits and to provide annotations to a larger selection of microbes.  

\section{Perspectives and future research}

Our work has shown promising applications of leveraging a taxa-function framework in epidemiological studies. By contextualizing shifts in taxonomic abundances in terms of their function, researchers can more easily interpret lists of differentially abundant taxa and make informed choices on what to follow-up and validate in laboratory experiments. However, there are still major hurdles to overcome before an integrative framework can be confidently applied to future studies. 

\subsection{Defining microbial function}

One of the most difficult aspects of investigating microbial function is the ability to identify meaningfully relevant definitions \cite{heintz-buschart2018human, zhang2019advancing, klassen2018defining}. Specifically, the question of how to translate between definitions of genes and pathways (from KEGG or MetaCyc) to ecosystem functions that the gut microbiome delivers. A relevant example is the role of HMO metabolism \cite{vatanen2018human}, which is a host-relevant function that contextualizes multiple gene families, all of which would be difficult to interpret individually.  

Chapter 4 of this thesis attempted to examine function under the lens of microbial traits. Traits are usually conceptualized as defined, measurable properties of organisms that link performance and contribution to core ecosystem needs \cite{krause2014traitbased}. While traits provide a more holistic conception of function, issues with unstandardized databases \cite{madin2020synthesis} and limited coverage for rare species makes it challenging to use in scenarios where they might be conferring important services.  

As such, comprehensive efforts are needed to centralize and standardize the ontology of microbial function with respect to ecosystem needs. Efforts such as the ontology of microbial phenotypes (OMP) \cite{chibucos2014ontology} have started to generate a repository of terminology to standardize description of microbial phenotypes. Researchers can further expand the types of annotations of OMP to be specific to body sites (using the uber-anatomy ontology - UBERON) or study conditions (using experimental factor ontology - EFO). KEGG terms or MetaCyc pathways can be assigned to OMP annotations, which can then be translated to specific strains using reference genomes/pangenomes or measured metatranscriptomic data. By defining a standardized vocabulary, researchers can begin to conceptualize a host-centric view of microbial function that is both standardized and context driven. 

\subsection{Leveraging multiple meta`omic technologies}

While there have been a large number of microbiome multi-omic studies (see section 1.2.2), they have mostly been focused on analyzing each data-layer independently with some studies performing limited taxa-function analyses. However, as shown in Chapter 2, paired profiling of microbiome structure and molecular functions can reveal novel aspects of host-microbe interactions. As such, multi-omic data sets, especially those including multiple layers of functional profiling, can be invaluable. 

Additionally, these data sets can be further leveraged in conjunction with the functional framework defined in section 5.2.1 in two ways: 

\begin{itemize}
    \item First, researchers can use these data sets directly to test for the enrichment of ecosystem-specific functional roles similar to that of Vatanen et al. \cite{vatanen2018human} and HMO metabolism. 
    \item Second, researchers can leverage the collection of these data sets to validate encoded taxa-function relationships, specifically accounting for situations where gene carriage does not directly correlate with expression \cite{franzosa2014relating}
    \item Third, they can be used to generate new core taxa-function relationships that can be disease-associated that can serve as biomarkers or as potential candidates for intervention. 
\end{itemize}

\subsection{Novel representations of taxa-function relationships}

To jointly test for association between taxa-function groups and relevant exposures or disease outcomes, there is a need to identify appropriate representations that can be translated into a statistical framework. Set-based approaches, used in Chapter 3, are simple but powerful methods. Sets naturally capture categorical information such as the assignment of strains to functions. However, the definition of sets are rigid, and does not account for nuances such as uncertainties or the degree of strain presence/absence in the overall population. As such, novel numerical representations of taxa-function relationships can help account for this gap and allow for a more flexible way to encode these relationships. 

One candidate would be to use weights within sets or across different sets depending on the experimental context. For example, Frost \cite{frost2018computation} curates a set of tissue-specific weights for MSigDB gene sets. Here, body-site specific weights can be computed for each functional term, or the contribution of each taxa can be weighted by its overall prevalence estimated from a large cohort such as HMP.  

Network-based methods offer another approach. Bipartite networks can be used to model connections between taxonomic and functional nodes \cite{tian2020decipheringa}. Networks also have topological features such as degree centrality that can provide extra dimensions such as being able to identify taxa that contribute to a large number of functions or vice versa. Standard network structures that allow for connections within taxonomic and functional nodes are also useful as they can account for inter-taxa correlation or dependencies between metabolites or genes. 

There are also machine-learning based approaches that can provide unique encoding opportunities. Word embeddings, such as Word2Vec \cite{mikolov2013efficient}, create dense numerical vectors that can represent high-dimensional co-occurrence relationships. This application has been explored in the context of the microbiome-metabolome relationship \cite{morton2019learning}. Researchers can extend this approach to model different functional outputs, or to provide pre-trained embeddings based on a meta-analysis of microbiome-metabolome data sets.  
